inherits: ['db.yaml']

global:
    seperator: ","
    use_schema: True
    name: "attrs"
    filetype: csv

    import_to_db: True

    web_paths:
      - url: "https://drive.google.com/uc?export=download&id=0B0fngGlnqNt7UElwVlRjcTctN2c"
        pattern: "*"

    source : "data/attrs/adm0.csv"
    output : "data/output/data-africa/geo_attrs/adm0/"

    rename:
      adm0_name: name
      adm0_code: adm0_id

tables:
  geo:
    pk: ["id", "name"]

    transform:
      - type: clone
        source: adm0_id
        column: id
      - type: zfill
        column: id
        size: 5
      - column: id
        type: concat_and_fill
        prefix: "040AF"
      - type: set_val
        column: adm1_id
        value: !!null
      - type: set_val
        column: level
        value: "adm0"
